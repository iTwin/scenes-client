{
  "$id": "/schemas/ExpressionStyling.1.0.0",
  "description": "Defines declarative styling options using expressions to control display properties based on element attributes.",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "stylingOptions": {
      "description": "Declarative styling options using expressions or categories to control display properties such as color, visibility, and appearance. Expressions are defined with JSEP (JavaScript Expression Parser) valid syntax.",
      "oneOf": [
        {
          "type": "object",
          "additionalProperties": false,
          "required": [ "styleType", "color" ],
          "properties": {
            "styleType": {
              "enum": [ "Expression" ],
              "description": "Specifies the type of styling: 'Expression' or 'Category'. This is used to differentiate between different styling methods."
            },
            "defines": {
              "type": "object",
              "description": "Named expressions that can be reused within other expressions",
              "additionalProperties": false,
              "patternProperties": {
                "^[a-zA-Z0-9 ?!@+-.:=_/]*$": {
                  "$ref": "/schemas/CommonTypes#/definitions/expressionString",
                  "description": "Expression string that can define conditions or calculations for styling"
                }
              }
            },
            "show": {
              "$ref": "/schemas/CommonTypes#/definitions/expressionOrConditions",
              "description": "Expression or conditions that determines if the feature is visible"
            },
            "color": {
              "description": "Expression or conditions that determine the feature's color, can also be a set of conditions",
              "$ref": "/schemas/CommonTypes#/definitions/expressionOrConditions"
            },
            "lineWeight": {
              "$ref": "/schemas/CommonTypes#/definitions/expressionOrConditions",
              "description": "Expression that determines the feature's line weight/thickness"
            },
            "lineColor": {
              "$ref": "/schemas/CommonTypes#/definitions/expressionOrConditions",
              "description": "Color definition for the feature's lines"
            }
          }
        },
        {
          "type": "object",
          "additionalProperties": false,
          "required": [ "styleType", "default", "rules" ],
          "properties": {
            "styleType": {
              "enum": [ "Category" ],
              "description": "Specifies the type of styling: 'Expression' or 'Category'. This is used to differentiate between different styling methods."
            },
            "default": {
              "$ref": "#/definitions/featureSymbology",
              "description": "Default symbology settings to apply when no attribute rules match."
            },
            "rules": {
              "type": "array",
              "description": "Array of Attribute rules",
              "items": {
                "type": "object",
                "additionalProperties": false,
                "required": [ "name", "value", "symbology" ],
                "properties": {
                  "name": {
                    "$ref": "/schemas/CommonTypes#/definitions/safeString",
                    "description": "Name of the attribute to match"
                  },
                  "value": {
                    "description": "Value of the attribute to match",
                    "oneOf": [
                      {
                        "$ref": "/schemas/CommonTypes#/definitions/restrictedString"
                      },
                      {
                        "type": "number"
                      },
                      {
                        "type": "boolean"
                      }
                    ]
                  },
                  "symbology": {
                    "$ref": "#/definitions/featureSymbology",
                    "description": "Symbology settings to apply when a rule matches or to describe appearance."
                  }
                }
              }
            }
          }
        }
      ]
    }
  },
  "definitions": {
    "featureSymbology": {
      "type": "object",
      "description": "Symbology settings to apply to an attributed feature",
      "additionalProperties": false,
      "required": [ "lineColor", "fillColor", "weight" ],
      "properties": {
        "lineColor": {
          "$ref": "/schemas/CommonTypes#/definitions/colorDef",
          "description": "Color of the feature's lines"
        },
        "fillColor": {
          "$ref": "/schemas/CommonTypes#/definitions/colorDef",
          "description": "Fill color of the feature"
        },
        "weight": {
          "type": "number",
          "description": "Thickness of the feature's lines"
        },
        "linePixels": {
          "$ref": "/schemas/CommonTypes#/definitions/linePixels",
          "description": "Line pattern for the feature's lines"
        }
      }
    }
  }
}
